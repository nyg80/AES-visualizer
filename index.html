<html>
<head>
<title>AES - Advanced Encryption Standard</title>
<script>
function populateMatrix()	{
	for (var i=0;i<16;i++)	{
		//alert(document.getElementsByName("hByte"+i)[0].value);
		document.getElementsByName("hMatrix"+i)[0].value = document.getElementsByName("hByte"+i)[0].value;
	}
}

var Sbox = new Array(99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,
  118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,
  147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,
  7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,
  47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,
  251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,
  188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,
  100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,
  50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,
  78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,
  116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,
  158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,
  137,13,191,230,66,104,65,153,45,15,176,84,187,22);
  
function subBytes()	{
	for (var i=0;i<16;i++)	{
		hexVal = parseInt(document.getElementsByName("hMatrix"+i)[0].value,16);
		document.getElementsByName("sMatrix"+i)[0].value = Sbox[hexVal].toString(16);
	}
}

function shiftRows()	{
	//ToDo: this is so ugly, make smaller using division of i
	for (var i=0;i<4;i++)	{
		document.getElementsByName("shMatrix"+i)[0].value = document.getElementsByName("sMatrix"+i)[0].value;
	}
	for (var i=4;i<7;i++)	{
		document.getElementsByName("shMatrix"+i)[0].value = document.getElementsByName("sMatrix"+(i+1))[0].value;
	}
	for (var i=15;i>12;i--)	{
		document.getElementsByName("shMatrix"+i)[0].value = document.getElementsByName("sMatrix"+(i-1))[0].value;
	}
	document.getElementsByName("shMatrix7")[0].value = document.getElementsByName("sMatrix4")[0].value;
	document.getElementsByName("shMatrix8")[0].value = document.getElementsByName("sMatrix10")[0].value;
	document.getElementsByName("shMatrix9")[0].value = document.getElementsByName("sMatrix11")[0].value;
	document.getElementsByName("shMatrix10")[0].value = document.getElementsByName("sMatrix8")[0].value;
	document.getElementsByName("shMatrix11")[0].value = document.getElementsByName("sMatrix9")[0].value;
	document.getElementsByName("shMatrix12")[0].value = document.getElementsByName("sMatrix15")[0].value;
}



//the below function was ripped from http://people.eku.edu/styere/Encrypt/JS-AES.html
function aes_mul( a, b )	{
   var res = 0;
   while( a > 0 )	{
      if ( (a&1) != 0 )
         res = res ^ b;		// "add" to the result
      a >>>= 1;			// shift a to get next higher-order bit
      b <<= 1;			// shift multiplier also
   }
   // now reduce it modulo x**8 + x**4 + x**3 + x + 1
   var hbit = 0x10000;		// bit to test if we need to take action
   var modulus = 0x11b00;	// modulus - XOR by this to change value
   while( hbit >= 0x100 )	{
      if ( (res & hbit) != 0 )		// if the high-order bit is set
         res ^= modulus;	// XOR with the modulus

      // prepare for the next loop
      hbit >>= 1;
      modulus >>= 1;
   }
   return res;
}



</script>
</head>
<body>
<p>AES takes an input of 128 bits, grouped into 16 bytes of 8 bits.  Enter your 128 bits below in either hexadecimal or binary format.</p>

<!-- ToDo:
	-- implement the mixColumns step
	-- put the buttons & matrices into a table for better page layout
	-- create a page for the key expansion
	-->

<p>hex: 
<input type="text" name="hByte0" maxlength="2" size="2">
<input type="text" name="hByte1" maxlength="2" size="2">
<input type="text" name="hByte2" maxlength="2" size="2">
<input type="text" name="hByte3" maxlength="2" size="2">
<input type="text" name="hByte4" maxlength="2" size="2">
<input type="text" name="hByte5" maxlength="2" size="2">
<input type="text" name="hByte6" maxlength="2" size="2">
<input type="text" name="hByte7" maxlength="2" size="2">
<input type="text" name="hByte8" maxlength="2" size="2">
<input type="text" name="hByte9" maxlength="2" size="2">
<input type="text" name="hByte10" maxlength="2" size="2">
<input type="text" name="hByte11" maxlength="2" size="2">
<input type="text" name="hByte12" maxlength="2" size="2">
<input type="text" name="hByte13" maxlength="2" size="2">
<input type="text" name="hByte14" maxlength="2" size="2">
<input type="text" name="hByte15" maxlength="2" size="2">
</p>
<p>These 16 bytes are then arranged into a 4 x 4 matrix.  From this matrix we will do the 10 rounds of the AES algorithm (if the key has 192 bits, it's 12 rounds, and when the key has 256 bits, it's 14 rounds).  Each round has 4 steps, Byte Substitution, Row Shifting, Column Mixing, then adding the Key for that round.</p>
<p><button onclick="populateMatrix()">Populate the Matrix</button>
<button onclick="subBytes()">Perform SubBytes Step</button>
<button onclick="shiftRows()">Perform ShiftRows Step</button>
<button onclick="mixColumns()">Perform MixColumns Step</button>
<button onclick="addRoundKey()">Perform Add Round Key Step</button></p>

<strong>Round 1</strong>
The SubByte transformation is the first step of each round.  Each byte in our matrix is substituted with another value.  The other value comes from what we call the S-Box.  
<br />
<strong>Initial</strong><br />
<input type="text" name="hMatrix0" maxlength="2" size="2">
<input type="text" name="hMatrix1" maxlength="2" size="2">
<input type="text" name="hMatrix2" maxlength="2" size="2">
<input type="text" name="hMatrix3" maxlength="2" size="2"><br />
<input type="text" name="hMatrix4" maxlength="2" size="2">
<input type="text" name="hMatrix5" maxlength="2" size="2">
<input type="text" name="hMatrix6" maxlength="2" size="2">
<input type="text" name="hMatrix7" maxlength="2" size="2"><br />
<input type="text" name="hMatrix8" maxlength="2" size="2">
<input type="text" name="hMatrix9" maxlength="2" size="2">
<input type="text" name="hMatrix10" maxlength="2" size="2">
<input type="text" name="hMatrix11" maxlength="2" size="2"><br />
<input type="text" name="hMatrix12" maxlength="2" size="2">
<input type="text" name="hMatrix13" maxlength="2" size="2">
<input type="text" name="hMatrix14" maxlength="2" size="2">
<input type="text" name="hMatrix15" maxlength="2" size="2"><br />
<br />
<input type="text" name="sMatrix0" maxlength="2" size="2">
<input type="text" name="sMatrix1" maxlength="2" size="2">
<input type="text" name="sMatrix2" maxlength="2" size="2">
<input type="text" name="sMatrix3" maxlength="2" size="2"><br />
<input type="text" name="sMatrix4" maxlength="2" size="2">
<input type="text" name="sMatrix5" maxlength="2" size="2">
<input type="text" name="sMatrix6" maxlength="2" size="2">
<input type="text" name="sMatrix7" maxlength="2" size="2"><br />
<input type="text" name="sMatrix8" maxlength="2" size="2">
<input type="text" name="sMatrix9" maxlength="2" size="2">
<input type="text" name="sMatrix10" maxlength="2" size="2">
<input type="text" name="sMatrix11" maxlength="2" size="2"><br />
<input type="text" name="sMatrix12" maxlength="2" size="2">
<input type="text" name="sMatrix13" maxlength="2" size="2">
<input type="text" name="sMatrix14" maxlength="2" size="2">
<input type="text" name="sMatrix15" maxlength="2" size="2"><br />
<br />
<input type="text" name="shMatrix0" maxlength="2" size="2">
<input type="text" name="shMatrix1" maxlength="2" size="2">
<input type="text" name="shMatrix2" maxlength="2" size="2">
<input type="text" name="shMatrix3" maxlength="2" size="2"><br />
<input type="text" name="shMatrix4" maxlength="2" size="2">
<input type="text" name="shMatrix5" maxlength="2" size="2">
<input type="text" name="shMatrix6" maxlength="2" size="2">
<input type="text" name="shMatrix7" maxlength="2" size="2"><br />
<input type="text" name="shMatrix8" maxlength="2" size="2">
<input type="text" name="shMatrix9" maxlength="2" size="2">
<input type="text" name="shMatrix10" maxlength="2" size="2">
<input type="text" name="shMatrix11" maxlength="2" size="2"><br />
<input type="text" name="shMatrix12" maxlength="2" size="2">
<input type="text" name="shMatrix13" maxlength="2" size="2">
<input type="text" name="shMatrix14" maxlength="2" size="2">
<input type="text" name="shMatrix15" maxlength="2" size="2"><br />
<br />
<input type="text" name="aMatrix0" maxlength="2" size="2">
<input type="text" name="aMatrix1" maxlength="2" size="2">
<input type="text" name="aMatrix2" maxlength="2" size="2">
<input type="text" name="aMatrix3" maxlength="2" size="2"><br />
<input type="text" name="aMatrix4" maxlength="2" size="2">
<input type="text" name="aMatrix5" maxlength="2" size="2">
<input type="text" name="aMatrix6" maxlength="2" size="2">
<input type="text" name="aMatrix7" maxlength="2" size="2"><br />
<input type="text" name="aMatrix8" maxlength="2" size="2">
<input type="text" name="aMatrix9" maxlength="2" size="2">
<input type="text" name="aMatrix10" maxlength="2" size="2">
<input type="text" name="aMatrix11" maxlength="2" size="2"><br />
<input type="text" name="aMatrix12" maxlength="2" size="2">
<input type="text" name="aMatrix13" maxlength="2" size="2">
<input type="text" name="aMatrix14" maxlength="2" size="2">
<input type="text" name="aMatrix15" maxlength="2" size="2"><br />



<p>binary:
<input type="text" name="bByte0" maxlength="8" size="8">
<input type="text" name="bByte1" maxlength="8" size="8">
<input type="text" name="bByte2" maxlength="8" size="8">
<input type="text" name="bByte3" maxlength="8" size="8">
<input type="text" name="bByte4" maxlength="8" size="8">
<input type="text" name="bByte5" maxlength="8" size="8">
<input type="text" name="bByte6" maxlength="8" size="8">
<input type="text" name="bByte7" maxlength="8" size="8">
<input type="text" name="bByte8" maxlength="8" size="8">
<input type="text" name="bByte9" maxlength="8" size="8">
<input type="text" name="bByte10" maxlength="8" size="8">
<input type="text" name="bByte11" maxlength="8" size="8">
<input type="text" name="bByte12" maxlength="8" size="8">
<input type="text" name="bByte13" maxlength="8" size="8">
<input type="text" name="bByte14" maxlength="8" size="8">
<input type="text" name="bByte15" maxlength="8" size="8">
</p>

Useful reference links:
<ul>
<li><a href="http://en.wikipedia.org/wiki/Finite_field_arithmetic#Multiplication">http://en.wikipedia.org/wiki/Finite_field_arithmetic#Multiplication</a></li>
<li><a href="http://people.eku.edu/styere/Encrypt/JS-AES.html">http://people.eku.edu/styere/Encrypt/JS-AES.html</a></li>
<li><a href="https://engineering.purdue.edu/kak/compsec/NewLectures/Lecture8.pdf">https://engineering.purdue.edu/kak/compsec/NewLectures/Lecture8.pdf</a></li>
<li><a href="http://www.cs.bc.edu/~straubin/cs381-05/blockciphers/rijndael_ingles2004.swf">http://www.cs.bc.edu/~straubin/cs381-05/blockciphers/rijndael_ingles2004.swf</a></li>
<li><a href="http://en.wikipedia.org/wiki/Advanced_Encryption_Standard">http://en.wikipedia.org/wiki/Advanced_Encryption_Standard</a></li>
<li><a href=""></a></li>
</ul>

</body>
</html>
